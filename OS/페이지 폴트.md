# 페이지 폴트 (Page Fault)

페이징 시스템에서 메모리 관리는 페이지 테이블과 TLB를 통해 이루어집니다.  
하지만 요청된 페이지가 메모리에 없을 때, 페이지 폴트가 발생합니다.

## 스왑 공간 (Swap Space)

메모리 크기는 제한적이므로, 사용 빈도가 낮은 페이지는 디스크의 **스왑 공간**으로 이동됩니다. 이를 **Swap out**이라 합니다.  
반대로, 스왑 공간에서 메모리로 페이지를 가져오는 것을 **Swap in**이라고 합니다.  
페이지 테이블은 각 페이지의 상태와 스왑 공간에서의 위치 정보를 관리합니다.

## 페이지 폴트 핸들링

1.  **페이지 폴트 발생**:  
    CPU가 요청한 페이지가 TLB에 없고, 페이지 테이블의 해당 항목(PTE)에서 present bit가 0으로 설정되어 있으면 페이지 폴트가 발생합니다.
2.  **페이지 폴트 핸들러**:  
    운영체제가 페이지 폴트 처리를 시작합니다. 유효하지 않은 접근인지 확인하는 과정도 포함됩니다.
3.  **페이지 위치 확인**:  
    PTE를 통해 스왑 공간에서의 페이지 위치를 확인합니다.
4.  **페이지 프레임 할당**:  
    메모리에서 빈 페이지 프레임을 찾거나, 페이지 교체 알고리즘에 따라 교체할 페이지를 선택합니다.
5.  **페이지 로드 (Swap in)**:  
    디스크에서 해당 페이지를 메모리로 로드합니다. 이 동안 CPU는 다른 프로세스에 제어권을 넘깁니다.
6.  **페이지 테이블 업데이트**:  
    PTE의 present bit를 1로 설정하고, 페이지 프레임 번호 등 관련 정보를 업데이트합니다.
7.  **TLB 업데이트**:  
    TLB에 새로운 페이지 정보를 추가합니다.
8.  **Instruction 재개**:  
    페이지 폴트가 발생했던 명령을 다시 실행합니다.

### 페이지 교체 (Page Replacement)

메모리가 가득 찰 경우, 페이지 교체 알고리즘을 사용하여 어떤 페이지를 스왑 아웃할지 결정합니다.

- **LW (Low Watermark), HW (High Watermark)**:  
  메모리 관리를 위한 지표입니다.  
  LW 이하로 사용 가능한 페이지가 줄면 페이지 교체를 시작하고, HW 이상으로 확보될 때까지 계속합니다.
- **클러스터링**:  
  여러 페이지를 묶어 한 번에 스왑 아웃하여 I/O 효율을 높입니다.
- **Dirty Bit**:  
  페이지가 수정되었는지 여부를 나타내는 비트입니다. 수정되지 않은 페이지만 스왑 아웃하여 I/O를 줄입니다.
