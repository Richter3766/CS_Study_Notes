## 메모리 주소 변환 (Memory Address Translation)

프로세스 실행을 위해서는 프로그램이 메모리에 로드되어야 하며, 스택과 힙 영역이 할당되어야 합니다.  
운영체제(OS)는 프로세스에게 메모리 가상화를 제공하여 효율적인 메모리 사용을 가능하게 합니다.  
즉, 프로세스는 메모리가 0부터 시작하는 충분히 큰 공간을 가진 것처럼 인식합니다.

### 메모리 가상화의 필요성

메모리 가상화는 다음과 같은 이점을 제공합니다.

- **프로세스 간 독립성**:
  - 각 프로세스는 독립적인 메모리 공간을 가지므로, 다른 프로세스의 메모리 영역에 접근할 수 없습니다.
  - 이는 보안 및 안정성을 향상시킵니다.
- **효율적인 메모리 관리**:
  - 프로세스는 연속적인 메모리 공간을 필요로 하지 않으므로
  - 운영체제는 물리 메모리의 빈 공간을 효율적으로 활용하여 여러 프로세스를 동시에 실행할 수 있습니다.
- **주소 공간 확장**:
  - 가상 메모리 주소 공간은 물리 메모리 크기보다 클 수 있습니다.
  - 이는 프로세스가 실제 물리 메모리보다 큰 메모리를 사용하는 것처럼 보이게 합니다.

### 메모리 가상화 구현 방식

운영체제는 프로세스의 메모리를 실제 물리 메모리에 로드합니다.  
이때 프로세스가 알고 있는 가상 메모리 주소와 실제 물리 메모리 주소는 다릅니다.  
이러한 주소 변환을 위해 MMU(Memory Management Unit)라는 하드웨어의 도움을 받습니다.

### MMU (Memory Management Unit)

MMU는 CPU 내부에 위치하여 가상 메모리 주소를 물리 메모리 주소로 변환하는 역할을 수행합니다.  
MMU는 다양한 주소 변환 기법을 사용하며, 대표적인 방법은 다음과 같습니다.

#### 1. Base/Bound Register 방식

- **동작 원리**:

  - **Base Register**:  
    해당 프로세스의 물리 메모리 시작 주소를 저장합니다.
  - **Bound Register**:  
    해당 프로세스에 할당된 메모리 공간의 크기(상한)를 저장합니다.

  - 가상 주소를 물리 주소로 변환할 때, MMU는 가상 주소에 Base Register 값을 더하여 물리 주소를 계산합니다.

  - 또한, 가상 주소가 Bound Register 값보다 큰지 확인하여 메모리 접근 오류를 방지합니다.

- **컨텍스트 스위칭**:  
  컨텍스트 스위칭 발생 시, CPU는 현재 프로세스의 Base/Bound Register 값을 저장하고, 다음 프로세스의 값을 로드해야 합니다.
- **단점**:
  - 프로세스의 모든 메모리가 연속적인 물리 메모리 공간에 할당되어야 합니다.
  - 메모리 단편화(Fragmentation) 문제 발생 가능성이 높습니다.

#### 2. 세그멘테이션 (Segmentation)

- **개념**:  
  프로세스의 메모리 공간을 논리적인 단위인 세그먼트(코드, 데이터, 스택, 힙 등)로 나누어 관리합니다.
- **동작 원리**:  
  각 세그먼트마다 Base Register와 Bound Register를 사용하여 독립적인 메모리 공간을 할당합니다.
- **장점**:
  - 프로세스의 메모리 공간을 더 효율적으로 관리할 수 있습니다.
  - 코드, 데이터, 스택, 힙 등 서로 다른 속성을 가진 영역을 분리하여 보호할 수 있습니다.
- **컨텍스트 스위칭**:  
  컨텍스트 스위칭 시, 각 세그먼트에 대한 Base/Bound Register 값을 저장하고 로드해야 합니다.
- **단점**:
  - 여전히 **외부 단편화**(External Fragmentation) 문제가 발생할 수 있습니다.

**외부 단편화** **(External Fragmentation)**:  
메모리에 사용 가능한 공간이 있지만, 프로세스에 할당하기에는 크기가 작은 조각들이 흩어져 있는 현상

### 외부 단편화 해결 방안

세그멘테이션 기법을 사용하더라도 외부 단편화 문제는 여전히 발생할 수 있습니다.  
이를 해결하기 위해 다음과 같은 방법을 사용할 수 있습니다.

- **메모리 압축 (Memory Compaction)**:  
  메모리에 흩어져 있는 빈 공간들을 모아 연속적인 큰 공간을 만드는 방법입니다. 하지만 압축 과정에서 많은 오버헤드가 발생할 수 있습니다.
- **페이징 (Paging)**:  
  프로세스의 메모리 공간을 고정 크기의 페이지로 나누어 관리하는 방법입니다.  
  페이징은 외부 단편화 문제를 해결하는 데 효과적이며, 현대 운영체제에서 널리 사용되는 메모리 관리 기법입니다. (페이징에 대한 자세한 내용은 별도로 다루어집니다.)
