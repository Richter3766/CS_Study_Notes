# 혼잡 제어(Congestion Control)

## 혼잡(Congestion)의 정의

**혼잡**(Congestion) 상태란 네트워크 내에 전송되는 패킷의 양이 네트워크가 수용할 수 있는 용량을 초과하는 상태를 의미합니다.

### 원인

- **과도한 트래픽**:  
  네트워크 용량을 초과하는 패킷 전송
- **버퍼 부족**:  
  라우터/스위치의 버퍼 용량 부족
- **처리 능력 부족**:  
  라우터/스위치의 패킷 처리 능력 부족
- **재전송 증가**:  
  패킷 손실로 인한 불필요한 재전송 증가
- **비효율적인 자원 사용**:  
  병목 현상, 잘못된 라우팅 등 네트워크 자원 비효율적 사용

### 혼잡 상태일 때 문제점

- **버퍼 오버플로우와 패킷 손실:**
  - 라우터나 스위치는 들어오는 패킷을 임시로 저장하기 위해 버퍼를 사용합니다.
  - 혼잡 상태에서는 버퍼에 저장해야 할 패킷의 양이 버퍼 용량을 초과하게 되고, 새로운 패킷을 저장할 공간이 부족해져 패킷 손실이 발생합니다.
- **재전송으로 인한 부하 증가:**
  - 패킷 손실이 발생하면 송신측은 해당 패킷을 재전송해야 합니다.
  - 이는 네트워크에 불필요한 트래픽을 추가하고, 혼잡을 더욱 심화시키는 악순환을 초래합니다.
- **패킷 처리 속도 저하:**
  - 라우터나 스위치가 처리해야 할 패킷의 양이 너무 많으면 패킷 처리 속도가 느려집니다.
  - 이는 모든 패킷의 지연 시간을 증가시키고, 네트워크 성능을 전반적으로 저하시킵니다.
- **타임아웃과 중복 패킷:**
  - 패킷 전송 후 일정 시간 내에 응답 (ACK)을 받지 못하면 송신측은 해당 패킷이 손실되었다고 판단하고 재전송합니다.
  - 하지만 실제로는 패킷이 손실되지 않고 지연되고 있는 경우, 중복 패킷이 네트워크에 추가되어 혼잡을 더욱 악화시킬 수 있습니다.

### 종단의 혼잡 인지

종단(end host)은 네트워크로부터 직접적인 혼잡 정보를 받지 못합니다.  
하지만 패킷 손실이나 지연 시간 증가와 같은 현상을 통해 간접적으로 혼잡을 인지할 수 있습니다.

- **지연 시간(Delay) 증가:**  
  패킷 전송 시간이 평소보다 길어지는 것은 네트워크 내에 패킷이 큐에 대기하는 시간이 늘어났음을 의미합니다.  
  이는 네트워크 자원이 부족하고 혼잡이 발생하고 있다는 간접적인 신호입니다.
- **패킷 손실(Packet Loss):**  
  패킷 손실은 라우터나 스위치의 버퍼 오버플로우로 인해 패킷이 폐기되었음을 의미합니다.  
  이는 네트워크가 극심한 혼잡 상태에 있음을 나타내는 강력한 신호입니다.

### 라우터의 명시적 혼잡 통지

- **ECN (Explicit Congestion Notification):**  
  일부 네트워크 환경에서는 라우터가 혼잡을 감지하면 패킷 헤더에 ECN 비트를 설정하여 송신측에 혼잡 사실을 알립니다.  
  이는 송신측이 혼잡에 더 빠르게 대응하고, 혼잡 제어 알고리즘을 효율적으로 작동시킬 수 있도록 돕습니다.

## TCP의 혼잡 제어
